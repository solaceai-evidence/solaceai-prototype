%% Solace-AI system architecture (component diagram)
%% File: docs/diagrams/architecture.mmd

graph LR
  subgraph ClientLayer
    B[Browser / Mobile App]
    CLI[CLI / Batch jobs]
  end

  subgraph APILayer
    API[API Gateway / HTTP API]
    Auth[Auth & Rate Limiting]
    LB[Load Balancer]
  end

  subgraph Orchestration
    Frontend[Web Frontend (React)]
    Orchestrator[SolaceAI Core Orchestrator]
    Manager[QueryRefinementManager]
    WorkerPool[Worker Pool / Task Queue]
  end

  subgraph DataLayer
    SessionStore[SessionStorage (Redis / InMemory)]
    VectorIndex[Vector DB / ANN Index]
    KnowledgeStore[Document Store / Blob Storage]
    Cache[Cache (Redis / Memcached)]
    DB[SQL / Metadata DB]
  end

  subgraph ModelLayer
    LLM[LLM Provider(s) (OpenAI / internal / hosted)]
    Embedder[Embedding Service]
    Retriever[Retriever Service / RAG]
  end

  subgraph Observability
    Tracing[Tracing (LangSmith / OpenTelemetry)]
    Metrics[Prometheus / Grafana]
    Logs[Centralized Logging]
  end

  B -->|HTTPS| API
  CLI -->|HTTPS| API
  API --> Auth
  API --> LB
  LB --> Frontend
  LB --> Orchestrator
  Frontend --> Orchestrator
  Orchestrator --> Manager
  Manager --> SessionStore
  Manager --> WorkerPool
  WorkerPool --> Retriever
  WorkerPool --> LLM
  WorkerPool --> Embedder
  Retriever --> VectorIndex
  Retriever --> KnowledgeStore
  Embedder --> VectorIndex
  Manager -->|requests embeddings| Embedder
  Manager -->|calls| LLM
  Retriever -->|reads| Cache
  Cache --> VectorIndex
  Manager --> DB

  Orchestrator --> Tracing
  LLM --> Tracing
  Retriever --> Tracing
  SessionStore --> Metrics
  Orchestrator --> Metrics
  Orchestrator --> Logs

  style ClientLayer fill:#f9f,stroke:#333,stroke-width:1px
  style APILayer fill:#bbf,stroke:#333,stroke-width:1px
  style Orchestration fill:#bfb,stroke:#333,stroke-width:1px
  style DataLayer fill:#ffd,stroke:#333,stroke-width:1px
  style ModelLayer fill:#fdd,stroke:#333,stroke-width:1px
  style Observability fill:#eee,stroke:#333,stroke-width:1px
